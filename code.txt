# --------------- PART 1 (EXTRACTION OF RAR FOLDERS) -------------------

# Script By: Areeba Azhar (DevOps)
# Last Updated On: 08/12/2023

$base_and_destination_path = "C:\Users\areeba.azhar\Desktop\Areeba\Powershell\PS_Task_8\PS_Script"
$rar_folders = Get-ChildItem $base_and_destination_path -Filter "*.rar" 


foreach ($rar_folder in $rar_folders)
{
    $WinRar = "C:\Program Files\WinRAR\WinRAR.exe"
    #basename = name of folder without the extension
    $base_naming = $rar_folder.BaseName

    # this is the where i want to extract the rar folders
    $destination_folder = Join-Path $base_and_destination_path $base_naming 
    #Write-Host "dest" $destination_folder

    # if the folder is not present, then make one
    if (-not (Test-Path $destination_folder -PathType Container)) {

         New-Item $destination_folder -ItemType Directory

    }


    # FullName gives the entire directory
    $rar_file_path = $rar_folder.FullName
    # for extracting rar files
    & $WinRar x "$rar_file_path" "$destination_folder"




}
# pause is given so that once extraction completes, only then the next part of code will be executed
#Start-Sleep -Seconds 5

# -------------- PART 2 ---------------------

# Script By: Areeba Azhar (DevOps) 
# Last Updated On: 08/12/2023

$base_and_destination_path = "C:\Users\areeba.azhar\Desktop\Areeba\Powershell\PS_Task_8\PS_Script"

# $merged_path = 'C:\Users\areeba.azhar\Desktop\Areeba\Powershell\PS_Task_8\PS_Script\Merged'

$extracted_folders = Get-ChildItem $base_and_destination_path -Directory

# if there are multiple folders (more than 1)
if ( $extracted_folders.Count -gt 1 ) {

    # skipping the first folder
    for ($i = 1; $i -lt $extracted_folders.Count; $i++) {

        $source_folder = Join-Path $base_and_destination_path $extracted_folders[$i].Name

        $destination_folder = Join-Path $base_and_destination_path $extracted_folders[0].Name

        # exclusing txt and sql files

        Get-ChildItem -Path $source_folder -File | Where-Object { $_.Extension -ne '.txt' -and $_.Extension -ne '.sql' } | ForEach-Object {

            $destination_path = Join-Path $destination_folder $_.Name
            Copy-Item -Path $_.FullName -Destination $destination_path -Force
            
        }

        # copying the content of destination folder to source folder
        #Copy-Item -Path "$source_folder\*" -Destination $destination_folder -Recurse -Force -Exclude *.txt *.sql

        # removing the current folder after merging
        #Remove-Item -Path $source_folder -Recurse -Force

    }

    # ------   merging 'files.txt' files --------
    $files_txt_destination = Join-Path $base_and_destination_path $extracted_folders[0].Name "Files.txt"

    # skipping the first folder
    for ($i = 1; $i -lt $extracted_folders.Count; $i++) {

        $source_txt_file = Join-Path $base_and_destination_path $extracted_folders[$i].Name "Files.txt"

        if (Test-Path $source_txt_file) {

            $source_txt_content = Get-Content -Path $source_txt_file -Raw

            $destination_txt_content = Get-Content -Path $files_txt_destination -Raw

            if ($source_txt_content -ne $destination_txt_content) {

                $merged_txt_content = $destination_txt_content + "'r'n" + $source_txt_content

                $merged_txt_content | Set-Content -Path $destination_txt_content

                Write-Host "Merging from $source_txt_content to $destination_txt_content has been completed"

            }

        }        
    }

    # ---------------- merging CureMD.sql files ---------------

    $destination_sql_file = Join-Path $base_and_destination_path $extracted_folders[0].Name "CureMD.sql" 

    # skipping the first folder
    for ($i = 1; $i -lt $extracted_folders.Count; $i++) {

        $source_sql_file = Join-Path $base_and_destination_path $extracted_folders[$i].Name "CureMD.sql"

        if (Test-Path $source_sql_file ) {

            $source_sql_content =  Get-Content -Path $source_sql_file -Raw

            $destination_sql_content = Get-Content -Path $destination_sql_file -Raw

            $merged_sql_content = $destination_sql_content + "'r'nGO'r'n" + $source_sql_content + "'r'nGO'r'n"

            $merged_sql_content | Set-Content -Path $destination_sql_content

            Write-Host "Merging from $source_sql_content to $destination_sql_content has been completed"

            
        }

    }

    Write-Host "Merging process has been completed."

}

else {

    Write-Host "No need for merging since there is only one folder."

}


----- error ------

PS C:\WINDOWS\system32> # --------------- PART 1 (EXTRACTION OF RAR FOLDERS) -------------------

# Script By: Areeba Azhar (DevOps) - Associate DevOps Engineer
# Last Updated On: 08/12/2023

$base_and_destination_path = "C:\Users\areeba.azhar\Desktop\Areeba\Powershell\PS_Task_8\PS_Script"
$rar_folders = Get-ChildItem $base_and_destination_path -Filter "*.rar" 


foreach ($rar_folder in $rar_folders)
{
    $WinRar = "C:\Program Files\WinRAR\WinRAR.exe"
    #basename = name of folder without the extension
    $base_naming = $rar_folder.BaseName

    # this is the where i want to extract the rar folders
    $destination_folder = Join-Path $base_and_destination_path $base_naming 
    #Write-Host "dest" $destination_folder

    # if the folder is not present, then make one
    if (-not (Test-Path $destination_folder -PathType Container)) {

         New-Item $destination_folder -ItemType Directory

    }


    # FullName gives the entire directory
    $rar_file_path = $rar_folder.FullName
    # for extracting rar files
    & $WinRar x "$rar_file_path" "$destination_folder"




}
# pause is given so that once extraction completes, only then the next part of code will be executed
#Start-Sleep -Seconds 5




    Directory: C:\Users\areeba.azhar\Desktop\Areeba\Powershell\PS_Task_8\PS_Script


Mode                 LastWriteTime         Length Name                                                                                                                    
----                 -------------         ------ ----                                                                                                                    
d-----         12/8/2023   6:15 AM                DailyPatchREL11_14-11-23                                                                                                
d-----         12/8/2023   6:15 AM                DailyPatchREL11_15-11-23                                                                                                
d-----         12/8/2023   6:15 AM                DailyPatchREL11_16-11-23                                                                                                
d-----         12/8/2023   6:15 AM                DailyPatchREL11_17-11-23                                                                                                
d-----         12/8/2023   6:15 AM                DailyPatchREL11_20-11-23                                                                                                
d-----         12/8/2023   6:15 AM                DailyPatchREL11_21-11-23                                                                                                
d-----         12/8/2023   6:15 AM                DailyPatchREL11_22-11-23                                                                                                
d-----         12/8/2023   6:15 AM                DailyPatchREL11_23-11-23                                                                                                
d-----         12/8/2023   6:15 AM                DailyPatchREL11_24-11-23                                                                                                
d-----         12/8/2023   6:15 AM                DailyPatchREL11_27-11-23                                                                                                
d-----         12/8/2023   6:15 AM                DailyPatchREL11_28-11-23                                                                                                
d-----         12/8/2023   6:15 AM                DailyPatchREL11_29-11-23                                                                                                



PS C:\WINDOWS\system32> # -------------- PART 2 ---------------------

# Script By: Areeba Azhar (DevOps) 
# Last Updated On: 08/12/2023

$base_and_destination_path = "C:\Users\areeba.azhar\Desktop\Areeba\Powershell\PS_Task_8\PS_Script"

# $merged_path = 'C:\Users\areeba.azhar\Desktop\Areeba\Powershell\PS_Task_8\PS_Script\Merged'

$extracted_folders = Get-ChildItem $base_and_destination_path -Directory

# if there are multiple folders (more than 1)
if ( $extracted_folders.Count -gt 1 ) {

    # skipping the first folder
    for ($i = 1; $i -lt $extracted_folders.Count; $i++) {

        $source_folder = Join-Path $base_and_destination_path $extracted_folders[$i].Name

        $destination_folder = Join-Path $base_and_destination_path $extracted_folders[0].Name

        # exclusing txt and sql files

        Get-ChildItem -Path $source_folder -File | Where-Object { $_.Extension -ne '.txt' -and $_.Extension -ne '.sql' } | ForEach-Object {

            $destination_path = Join-Path $destination_folder $_.Name
            Copy-Item -Path $_.FullName -Destination $destination_path -Force
            
        }

        # copying the content of destination folder to source folder
        #Copy-Item -Path "$source_folder\*" -Destination $destination_folder -Recurse -Force -Exclude *.txt *.sql

        # removing the current folder after merging
        #Remove-Item -Path $source_folder -Recurse -Force

    }

    # ------   merging 'files.txt' files --------
    $files_txt_destination = Join-Path $base_and_destination_path $extracted_folders[0].Name "Files.txt"

    # skipping the first folder
    for ($i = 1; $i -lt $extracted_folders.Count; $i++) {

        $source_txt_file = Join-Path $base_and_destination_path $extracted_folders[$i].Name "Files.txt"

        if (Test-Path $source_txt_file) {

            $source_txt_content = Get-Content -Path $source_txt_file -Raw

            $destination_txt_content = Get-Content -Path $files_txt_destination -Raw

            if ($source_txt_content -ne $destination_txt_content) {

                $merged_txt_content = $destination_txt_content + "'r'n" + $source_txt_content

                $merged_txt_content | Set-Content -Path $destination_txt_content

                Write-Host "Merging from $source_txt_content to $destination_txt_content has been completed"

            }

        }        
    }

    # ---------------- merging CureMD.sql files ---------------

    $destination_sql_file = Join-Path $base_and_destination_path $extracted_folders[0].Name "CureMD.sql" 

    # skipping the first folder
    for ($i = 1; $i -lt $extracted_folders.Count; $i++) {

        $source_sql_file = Join-Path $base_and_destination_path $extracted_folders[$i].Name "CureMD.sql"

        if (Test-Path $source_sql_file ) {

            $source_sql_content =  Get-Content -Path $source_sql_file -Raw

            $destination_sql_content = Get-Content -Path $destination_sql_file -Raw

            $merged_sql_content = $destination_sql_content + "'r'nGO'r'n" + $source_sql_content + "'r'nGO'r'n"

            $merged_sql_content | Set-Content -Path $destination_sql_content

            Write-Host "Merging from $source_sql_content to $destination_sql_content has been completed"

            
        }

    }

    Write-Host "Merging process has been completed."

}

else {

    Write-Host "No need for merging since there is only one folder."

}



Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:40 char:30
+ ... stination = Join-Path $base_and_destination_path $extracted_folders[0 ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:45 char:28
+ ... _txt_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:47 char:23
+         if (Test-Path $source_txt_file) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:45 char:28
+ ... _txt_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:47 char:23
+         if (Test-Path $source_txt_file) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:45 char:28
+ ... _txt_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:47 char:23
+         if (Test-Path $source_txt_file) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:45 char:28
+ ... _txt_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:47 char:23
+         if (Test-Path $source_txt_file) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:45 char:28
+ ... _txt_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:47 char:23
+         if (Test-Path $source_txt_file) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:45 char:28
+ ... _txt_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:47 char:23
+         if (Test-Path $source_txt_file) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:45 char:28
+ ... _txt_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:47 char:23
+         if (Test-Path $source_txt_file) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:45 char:28
+ ... _txt_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:47 char:23
+         if (Test-Path $source_txt_file) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:45 char:28
+ ... _txt_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:47 char:23
+         if (Test-Path $source_txt_file) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:45 char:28
+ ... _txt_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:47 char:23
+         if (Test-Path $source_txt_file) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'Files.txt'.
At line:45 char:28
+ ... _txt_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:47 char:23
+         if (Test-Path $source_txt_file) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:68 char:29
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[0 ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:73 char:28
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:75 char:23
+         if (Test-Path $source_sql_file ) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:73 char:28
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:75 char:23
+         if (Test-Path $source_sql_file ) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:73 char:28
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:75 char:23
+         if (Test-Path $source_sql_file ) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:73 char:28
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:75 char:23
+         if (Test-Path $source_sql_file ) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:73 char:28
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:75 char:23
+         if (Test-Path $source_sql_file ) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:73 char:28
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:75 char:23
+         if (Test-Path $source_sql_file ) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:73 char:28
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:75 char:23
+         if (Test-Path $source_sql_file ) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:73 char:28
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:75 char:23
+         if (Test-Path $source_sql_file ) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:73 char:28
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:75 char:23
+         if (Test-Path $source_sql_file ) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:73 char:28
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:75 char:23
+         if (Test-Path $source_sql_file ) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Join-Path : A positional parameter cannot be found that accepts argument 'CureMD.sql'.
At line:73 char:28
+ ... _sql_file = Join-Path $base_and_destination_path $extracted_folders[$ ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (:) [Join-Path], ParameterBindingException
    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell.Commands.JoinPathCommand
 
Test-Path : Cannot bind argument to parameter 'Path' because it is null.
At line:75 char:23
+         if (Test-Path $source_sql_file ) {
+                       ~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidData: (:) [Test-Path], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.TestPathCommand
 
Merging process has been completed.

PS C:\WINDOWS\system32> 